<!DOCTYPE html>
<html>
  <head>
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- codemirror (in browser editing) -->
    <script src="../CodeMirror/lib/codemirror.js"></script>
    <!-- theme -->
    <link rel="stylesheet" href="../CodeMirror/lib/codemirror.css">
    <link rel="stylesheet" href="../CodeMirror/theme/monokai.css">
    <!-- syntax hilighting -->
    <script src="../CodeMirror/mode/javascript/javascript.js"></script>
    <!-- line hilighting -->
    <script src="../CodeMirror/addon/selection/active-line.js"></script>
    <!-- match brackets -->
    <script src="../CodeMirror/addon/edit/matchbrackets.js"></script>
    <style>
    /* style the editing area */
    .CodeMirror{
      border: 1px solid rgb(255,255,255);
      margin: 10px;
    }
    </style>

    <style>
      html {
      position: relative;
      min-height: 100%;
      }
      body {
      margin-bottom: 60px;
      background-color: #EAEAEA;
      }
      .footer {
      /* Positioning */
      position: absolute;
      bottom: 0;
      width: 100%;
      /* Set the fixed height of the footer here */
      height: 60px;
      line-height: 60px; /* Vertically center the text there */
      /* Look */
      /*background-color: #000000;*/
      }
      #lastModified {
      color: #AAAAAA;
      }
      .jumbotron {
      padding:0px;
      background-color:#000000;
      }
      #imageContainer {
      margin-left: auto; 
      margin-right: auto; 
      width:75%; 
      min-width:800px;
      }
    </style>
    <style>
      #mycanvas {
      width: 500px;
      height: 500px;
      overflow: hidden;
      }
    </style>
  </head>
  <body>
    <!-- navbar content is filled in with navbar.js, using its id -->
    <nav class="navbar navbar-inverse" id="pageNav">
      <script src="../javascript/navbar.js"></script>
    </nav>
  
<div class="container">
  <div class="row">
    <div class="col-xs-10 col-xs-offset-1">
      <div style="width:500px; height:500px; margin-left: auto; margin-right: auto;">
        <canvas id="mycanvas" width="500" height="500"></canvas>
      </div>
    </div>
  </div>

  <div class="panel" style="margin-top:20px;">

    <div class="row">
      <div class="col-sm-12">
        <!-- panel throught the different files -->
          <ul class="nav nav-pills">
            <!--<li class="active"><a data-toggle="pill" href="#mainJS">main.js</a></li>
            <li><a data-toggle="pill" href="#initGLjs">initGL.js</a></li>
            <li><a data-toggle="pill" href="#getShaderJS">getShader.js</a></li>
            <li><a data-toggle="pill" href="#initShadersJS">initShaders.js</a></li>
            <li><a data-toggle="pill" href="#vertexShaderJS">vertexShader.js</a></li>
            <li><a data-toggle="pill" href="#fragmentShaderJS">fragmentShader.js</a></li>
            <li><a data-toggle="pill" href="#initBuffersJS">initBuffers.js</a></li>
            <li><a data-toggle="pill" href="#drawSceneJS">drawScene.js</a></li> -->
        </ul>
      </div>
    </div>

    <div class="row">
      <!-- data for the panel -->
      <div class="col-sm-12">
        <!--
        <div class="tab-content" style="margin-left:20px;margin-right:20px;">
          <div id="mainJS" class="tab-pane fade in active">
            <pre><code class="language-JavaScript" id="mainJSEmbed"></code>
            </pre>
          </div>
          <div id="initGLjs" class="tab-pane fade">
              <pre><code class="language-JavaScript" id="initGLjsEmbed"></code>
              </pre>
            </div>
        </div>-->

        <!-- codemirror editor area -->
        <textarea id="editorArea1">
function createBall(){
    var ballObj = {
        radius: 10,
        x: 0,
        y: 0,
        vx: 0.0,
        vy: 0.0,
        ax: 0.0,
        ay: 0.0,
        mass: 5.0,
        elast: -0.5,
        forceX: 0.0,
        forceY: 0.0
    };
    
    ballObj.x = ballObj.radius;
    ballObj.y = ballObj.radius;
    
    return ballObj;
}

function calcPhysics(ball, timestep){
    /* apply physics */
    ball.forceY = ball.mass * ball.ay; // f=ma
    ball.ay = ball.forceY / ball.mass; // a=f/m

    ball.forceX = ball.mass * ball.ax;
    ball.ax = ball.forceX / ball.mass;

    /* apply y acceleration and velocity */
    ball.vy += ball.ay * timestep; // apply gravity	
    ball.y += ball.vy * timestep; // move the ball

    /* apply x acceleration and velocity */
    ball.vx += ball.ax * timestep;
    ball.x += ball.vx * timestep;
}

function startPhysics() {
    var canvas = document.getElementById("mycanvas");
    var ctx = canvas.getContext('2d');

    /* add the width and height for calculations below */
    canvas.width = 500;
    canvas.height = 500;

    /* some physics variables */
    var accelGrav = 9.8; // 9.8m/s^2
    var timeStep = 0.07; // time increment per frame

    /* create a new ball object */
    var ball1 = createBall();
    /* move it to the center of the screen */
    ball1.x = canvas.width / 2 - ball1.radius;
  
    /* give the ball initial acceleration */
    ball1.ax = 0.0;
    ball1.ay = accelGrav;

    function main() {

        /* apply gravity, force, physics to the ball */
        calcPhysics(ball1, timeStep);

        /* if the ball hits the ground 
         * (vertical hit detection) */
        if (ball1.y > canvas.height - ball1.radius && ball1.vy > 0) {
            /* apply the 'ball1.elastic' force */
            ball1.vy *= ball1.elast;

            /* move the ball away from the wall a little so it doesn't get stuck */
            ball1.y = canvas.height - ball1.radius;
        }

        /* if the ball hits the left or right wall */
        if ((ball1.x > canvas.width - ball1.radius || ball1.x < 0.0 + ball1.radius) && ball1.vx != 0) {
            ball1.vx *= ball1.elast;

            /* move it away from the left or right wall if necessary */
            if (ball1.x < 0) ball1.x = ball1.radius;
            else if (ball1.x > canvas.width - ball1.radius) ball1.x = canvas.width - ball1.radius;
        }

        /* clear the screen */
        ctx.fillStyle = "#FFFFFF";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        /* draw a circle */
        ctx.fillStyle = "#000000";
        ctx.beginPath();
        ctx.arc(ball1.x, ball1.y, ball1.radius, 0, 2 * Math.PI);
        ctx.stroke();

        /* run the function again */
        requestAnimationFrame(main);
    }

    /* start the main loop */
    main();
}

startPhysics(); // call the above function
        </textarea>
        <button class="btn btn-primary" id="runButton">Run</button>
        <!--  -->
        <script>

          /* create code mirror from the text area */
          var editor = CodeMirror.fromTextArea(document.getElementById('editorArea1'), {
            theme: "monokai",
            mode: "javascript",
            indentUnit: 4,
            lineNumbers: true,
            styleActiveLine: true,
            matchBrackets: true
          });

          /* run the text as a function */
          var button = document.getElementById('runButton');
          button.onclick = function() {
            var animate = new Function(editor.getValue());
            animate();
          };

          /* Run the function when the web page loads */
          var initialFunc = new Function(editor.getValue());
          initialFunc();
        </script>
      </div>
    </div>

  </div>

</div>

  <!--
          <div class="col-xs-12">
      <pre><code class="language-javascript" id="embeddedCode"></code></pre>
      </div> -->
  
    <!-- footer content is filled in with footer.js, using its id -->
    <footer class="footer" id="pageFooter">
      <script src="../javascript/footer.js"></script>
    </footer>
  
  
    <!-- last modified will exist after footer.js enters the elements
      into pageFooter -->
    <script>
      var p = document.getElementById('lastModified');
      var modString = "Last Modified: ";
      modString += document.lastModified;
      p.innerHTML = modString;
    </script>
  </body>
</html>